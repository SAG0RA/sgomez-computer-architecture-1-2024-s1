import tkinter as tk
from tkinter import filedialog
from pydub import AudioSegment
import numpy as np

def obtener_muestras(audio_file):
    # Cargar el archivo de audio
    audio = AudioSegment.from_mp3(audio_file)

    # Convertir el audio a datos de tipo numpy array
    audio_array = np.array(audio.get_array_of_samples())

    return audio_array

def guardar_muestras_en_txt(muestras, output_file):
    with open(output_file, 'w') as f:
        for muestra in muestras:
            f.write(str(muestra) + '\n')

def reconstruir_audio_desde_txt(input_file):
    # Obtener la ruta del archivo de audio original
    original_audio_file = input_file.replace("muestras.txt", "song.mp3")

    # Cargar el archivo de audio original
    audio = AudioSegment.from_mp3(original_audio_file)
    original_sample_rate = audio.frame_rate
    original_sample_width = audio.sample_width
    original_channels = audio.channels

    # Leer las muestras del archivo de texto
    with open(input_file, 'r') as f:
        muestras_str = f.readlines()

    # Convertir las muestras de texto a un array numpy de enteros
    muestras = np.array([int(muestra.strip()) for muestra in muestras_str], dtype=np.int16)

    # Crear un objeto AudioSegment a partir de las muestras y el muestreo original
    audio_reconstruido = AudioSegment(
        data=muestras.tobytes(),
        sample_width=original_sample_width,
        frame_rate=original_sample_rate,
        channels=original_channels
    )

    return audio_reconstruido

def procesar_archivo():
    archivo_mp3 = filedialog.askopenfilename(filetypes=[("Archivos MP3", "*.mp3")])
    if archivo_mp3:
        muestras_audio = obtener_muestras(archivo_mp3)
        archivo_txt = "muestras.txt"
        guardar_muestras_en_txt(muestras_audio, archivo_txt)
        print(f"Las muestras de audio se han guardado en '{archivo_txt}'")


# Crear la ventana principal
root = tk.Tk()
root.title("Procesador de Audio")

# Crear un bot√≥n para seleccionar el archivo
boton_seleccionar = tk.Button(root, text="Seleccionar Archivo MP3", command=procesar_archivo)
boton_seleccionar.pack(pady=20)



root.mainloop()



